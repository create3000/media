#X3D V4.0 utf8 X_ITE V8.4.1

PROFILE Interchange

COMPONENT CADGeometry : 2
COMPONENT Scripting : 1

META "comment" "World of Titania"
META "created" "Tue, 10 Jul 2018 16:12:19 GMT"
META "creator" "Holger Seelig"
META "generator" "x3d-tidy V1.0.6, https://github.com/create3000/x3d-tidy#readme"
META "identifier" "file:///home/holger/Projekte/Sunrise/src/drive/user/test/components/Rendering/ColorRGBA/ColorRGBA.O.x3d"
META "modified" "Mon, 07 Jan 2019 03:23:50 GMT"

EXTERNPROTO Noise [
  inputOutput SFBool  enabled
  inputOutput SFFloat amplitude
  inputOutput SFFloat frequency
  inputOutput SFFloat phase
  outputOnly  SFFloat value_changed
]
"assets/Noise.x3d#Noise"

PROTO GraphicDisplay [
  inputOnly   SFFloat set_value
  inputOutput SFInt32 width 10
  inputOutput SFInt32 height 10
  inputOutput SFVec2f size 1 1
  inputOutput SFVec2f spacing 0.1 0.1
]
{
  DEF _1 QuadSet {
    colorPerVertex FALSE
    color ColorRGBA {
      color [ 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 1 0.6 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.8 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0.2 1 0 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 0.4 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 1 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0 0.4 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.2 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 0.8 0 1 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1, 1 0 0.6 1 ]
    }
    coord Coordinate {
      point [ 0 0 0, 1 0 0, 1 1 0, 0 1 0, 0 1.1 0, 1 1.1 0, 1 2.1 0, 0 2.1 0, 0 2.2 0, 1 2.2 0, 1 3.2 0, 0 3.2 0, 0 3.3 0, 1 3.3 0, 1 4.3 0, 0 4.3 0, 0 4.4 0, 1 4.4 0, 1 5.4 0, 0 5.4 0, 0 5.5 0, 1 5.5 0, 1 6.5 0, 0 6.5 0, 0 6.6 0, 1 6.6 0, 1 7.6 0, 0 7.6 0, 0 7.7 0, 1 7.7 0, 1 8.7 0, 0 8.7 0, 0 8.8 0, 1 8.8 0, 1 9.8 0, 0 9.8 0, 0 9.9 0, 1 9.9 0, 1 10.9 0, 0 10.9 0, 1.1 0 0, 2.1 0 0, 2.1 1 0, 1.1 1 0, 1.1 1.1 0, 2.1 1.1 0, 2.1 2.1 0, 1.1 2.1 0, 1.1 2.2 0, 2.1 2.2 0, 2.1 3.2 0, 1.1 3.2 0, 1.1 3.3 0, 2.1 3.3 0, 2.1 4.3 0, 1.1 4.3 0, 1.1 4.4 0, 2.1 4.4 0, 2.1 5.4 0, 1.1 5.4 0, 1.1 5.5 0, 2.1 5.5 0, 2.1 6.5 0, 1.1 6.5 0, 1.1 6.6 0, 2.1 6.6 0, 2.1 7.6 0, 1.1 7.6 0, 1.1 7.7 0, 2.1 7.7 0, 2.1 8.7 0, 1.1 8.7 0, 1.1 8.8 0, 2.1 8.8 0, 2.1 9.8 0, 1.1 9.8 0, 1.1 9.9 0, 2.1 9.9 0, 2.1 10.9 0, 1.1 10.9 0, 2.2 0 0, 3.2 0 0, 3.2 1 0, 2.2 1 0, 2.2 1.1 0, 3.2 1.1 0, 3.2 2.1 0, 2.2 2.1 0, 2.2 2.2 0, 3.2 2.2 0, 3.2 3.2 0, 2.2 3.2 0, 2.2 3.3 0, 3.2 3.3 0, 3.2 4.3 0, 2.2 4.3 0, 2.2 4.4 0, 3.2 4.4 0, 3.2 5.4 0, 2.2 5.4 0, 2.2 5.5 0, 3.2 5.5 0, 3.2 6.5 0, 2.2 6.5 0, 2.2 6.6 0, 3.2 6.6 0, 3.2 7.6 0, 2.2 7.6 0, 2.2 7.7 0, 3.2 7.7 0, 3.2 8.7 0, 2.2 8.7 0, 2.2 8.8 0, 3.2 8.8 0, 3.2 9.8 0, 2.2 9.8 0, 2.2 9.9 0, 3.2 9.9 0, 3.2 10.9 0, 2.2 10.9 0, 3.3 0 0, 4.3 0 0, 4.3 1 0, 3.3 1 0, 3.3 1.1 0, 4.3 1.1 0, 4.3 2.1 0, 3.3 2.1 0, 3.3 2.2 0, 4.3 2.2 0, 4.3 3.2 0, 3.3 3.2 0, 3.3 3.3 0, 4.3 3.3 0, 4.3 4.3 0, 3.3 4.3 0, 3.3 4.4 0, 4.3 4.4 0, 4.3 5.4 0, 3.3 5.4 0, 3.3 5.5 0, 4.3 5.5 0, 4.3 6.5 0, 3.3 6.5 0, 3.3 6.6 0, 4.3 6.6 0, 4.3 7.6 0, 3.3 7.6 0, 3.3 7.7 0, 4.3 7.7 0, 4.3 8.7 0, 3.3 8.7 0, 3.3 8.8 0, 4.3 8.8 0, 4.3 9.8 0, 3.3 9.8 0, 3.3 9.9 0, 4.3 9.9 0, 4.3 10.9 0, 3.3 10.9 0, 4.4 0 0, 5.4 0 0, 5.4 1 0, 4.4 1 0, 4.4 1.1 0, 5.4 1.1 0, 5.4 2.1 0, 4.4 2.1 0, 4.4 2.2 0, 5.4 2.2 0, 5.4 3.2 0, 4.4 3.2 0, 4.4 3.3 0, 5.4 3.3 0, 5.4 4.3 0, 4.4 4.3 0, 4.4 4.4 0, 5.4 4.4 0, 5.4 5.4 0, 4.4 5.4 0, 4.4 5.5 0, 5.4 5.5 0, 5.4 6.5 0, 4.4 6.5 0, 4.4 6.6 0, 5.4 6.6 0, 5.4 7.6 0, 4.4 7.6 0, 4.4 7.7 0, 5.4 7.7 0, 5.4 8.7 0, 4.4 8.7 0, 4.4 8.8 0, 5.4 8.8 0, 5.4 9.8 0, 4.4 9.8 0, 4.4 9.9 0, 5.4 9.9 0, 5.4 10.9 0, 4.4 10.9 0, 5.5 0 0, 6.5 0 0, 6.5 1 0, 5.5 1 0, 5.5 1.1 0, 6.5 1.1 0, 6.5 2.1 0, 5.5 2.1 0, 5.5 2.2 0, 6.5 2.2 0, 6.5 3.2 0, 5.5 3.2 0, 5.5 3.3 0, 6.5 3.3 0, 6.5 4.3 0, 5.5 4.3 0, 5.5 4.4 0, 6.5 4.4 0, 6.5 5.4 0, 5.5 5.4 0, 5.5 5.5 0, 6.5 5.5 0, 6.5 6.5 0, 5.5 6.5 0, 5.5 6.6 0, 6.5 6.6 0, 6.5 7.6 0, 5.5 7.6 0, 5.5 7.7 0, 6.5 7.7 0, 6.5 8.7 0, 5.5 8.7 0, 5.5 8.8 0, 6.5 8.8 0, 6.5 9.8 0, 5.5 9.8 0, 5.5 9.9 0, 6.5 9.9 0, 6.5 10.9 0, 5.5 10.9 0, 6.6 0 0, 7.6 0 0, 7.6 1 0, 6.6 1 0, 6.6 1.1 0, 7.6 1.1 0, 7.6 2.1 0, 6.6 2.1 0, 6.6 2.2 0, 7.6 2.2 0, 7.6 3.2 0, 6.6 3.2 0, 6.6 3.3 0, 7.6 3.3 0, 7.6 4.3 0, 6.6 4.3 0, 6.6 4.4 0, 7.6 4.4 0, 7.6 5.4 0, 6.6 5.4 0, 6.6 5.5 0, 7.6 5.5 0, 7.6 6.5 0, 6.6 6.5 0, 6.6 6.6 0, 7.6 6.6 0, 7.6 7.6 0, 6.6 7.6 0, 6.6 7.7 0, 7.6 7.7 0, 7.6 8.7 0, 6.6 8.7 0, 6.6 8.8 0, 7.6 8.8 0, 7.6 9.8 0, 6.6 9.8 0, 6.6 9.9 0, 7.6 9.9 0, 7.6 10.9 0, 6.6 10.9 0, 7.7 0 0, 8.7 0 0, 8.7 1 0, 7.7 1 0, 7.7 1.1 0, 8.7 1.1 0, 8.7 2.1 0, 7.7 2.1 0, 7.7 2.2 0, 8.7 2.2 0, 8.7 3.2 0, 7.7 3.2 0, 7.7 3.3 0, 8.7 3.3 0, 8.7 4.3 0, 7.7 4.3 0, 7.7 4.4 0, 8.7 4.4 0, 8.7 5.4 0, 7.7 5.4 0, 7.7 5.5 0, 8.7 5.5 0, 8.7 6.5 0, 7.7 6.5 0, 7.7 6.6 0, 8.7 6.6 0, 8.7 7.6 0, 7.7 7.6 0, 7.7 7.7 0, 8.7 7.7 0, 8.7 8.7 0, 7.7 8.7 0, 7.7 8.8 0, 8.7 8.8 0, 8.7 9.8 0, 7.7 9.8 0, 7.7 9.9 0, 8.7 9.9 0, 8.7 10.9 0, 7.7 10.9 0, 8.8 0 0, 9.8 0 0, 9.8 1 0, 8.8 1 0, 8.8 1.1 0, 9.8 1.1 0, 9.8 2.1 0, 8.8 2.1 0, 8.8 2.2 0, 9.8 2.2 0, 9.8 3.2 0, 8.8 3.2 0, 8.8 3.3 0, 9.8 3.3 0, 9.8 4.3 0, 8.8 4.3 0, 8.8 4.4 0, 9.8 4.4 0, 9.8 5.4 0, 8.8 5.4 0, 8.8 5.5 0, 9.8 5.5 0, 9.8 6.5 0, 8.8 6.5 0, 8.8 6.6 0, 9.8 6.6 0, 9.8 7.6 0, 8.8 7.6 0, 8.8 7.7 0, 9.8 7.7 0, 9.8 8.7 0, 8.8 8.7 0, 8.8 8.8 0, 9.8 8.8 0, 9.8 9.8 0, 8.8 9.8 0, 8.8 9.9 0, 9.8 9.9 0, 9.8 10.9 0, 8.8 10.9 0, 9.9 0 0, 10.9 0 0, 10.9 1 0, 9.9 1 0, 9.9 1.1 0, 10.9 1.1 0, 10.9 2.1 0, 9.9 2.1 0, 9.9 2.2 0, 10.9 2.2 0, 10.9 3.2 0, 9.9 3.2 0, 9.9 3.3 0, 10.9 3.3 0, 10.9 4.3 0, 9.9 4.3 0, 9.9 4.4 0, 10.9 4.4 0, 10.9 5.4 0, 9.9 5.4 0, 9.9 5.5 0, 10.9 5.5 0, 10.9 6.5 0, 9.9 6.5 0, 9.9 6.6 0, 10.9 6.6 0, 10.9 7.6 0, 9.9 7.6 0, 9.9 7.7 0, 10.9 7.7 0, 10.9 8.7 0, 9.9 8.7 0, 9.9 8.8 0, 10.9 8.8 0, 10.9 9.8 0, 9.9 9.8 0, 9.9 9.9 0, 10.9 9.9 0, 10.9 10.9 0, 9.9 10.9 0 ]
    }
  }

  DEF GraphicDisplayScript Script {
    inputOnly   SFFloat set_value IS set_value
    inputOutput SFTime  updateInterval 0.05
    inputOutput SFInt32 width IS width
    inputOutput SFInt32 height IS height
    inputOutput SFVec2f size IS size
    inputOutput SFVec2f spacing IS spacing
    inputOutput SFNode  geometry USE _1

    url "ecmascript:

var
	points   = [ ],
	lastTime = 0;

function initialize ()
{
	build ();
}

function set_value (value, time)
{
	if (lastTime == 0)
		lastTime = time;

	var dt = time - lastTime;

	if (dt < updateInterval)
		return;
		
	if (points .length > width)
		points .shift ();

	points .push (value);
	
	lastTime = time;
	
	animate ();
}

function set_width ()
{
	build ();
}

function set_height ()
{
	build ();
}

function set_size ()
{
	build ();
}

function set_spacing ()
{
	build ();
}

function build ()
{
	var
		hsva  = new SFColorRGBA (1, 1, 1, 1),
		color = geometry .color .color,
		coord = geometry .coord .point;

	lastTime       = 0;
	points .length = 0;
	color .length  = 0;
	coord .length  = 0;

	for (var w = 0; w < width; ++ w)
	{
		for (var h = 0; h < height; ++ h)
		{
			var
				x1  = size .x * w + spacing .x * w,
				x2  = x1 + size .x,
				y1  = size .y * h + spacing .y * h,
				y2  = y1 + size .y
				hue = w / width * 2 * Math .PI;

			hsva .setHSVA (hue, 1, 1, 1);

			color .push (hsva);
				
			coord .push (new SFVec3f (x1, y1, 0));
			coord .push (new SFVec3f (x2, y1, 0));
			coord .push (new SFVec3f (x2, y2, 0));
			coord .push (new SFVec3f (x1, y2, 0));
		}
	}
}

function animate ()
{
	var color = geometry .color .color;
		
	for (var w = 0; w < points .length; ++ w)
	{
		var value = (points [w] + 1) * 0.5 * height;

		for (var h = 0; h < height; ++ h)
		{
			var
				i = w * height + h,
				c = color [i];
		
			if (value > h)
			{
				c .a = 1;
			}
			else
			{
				if (c .a == 1)
					c .a = 0.5;
				else
					c .a *= 0.8;
			}
		}
	}
}"
    directOutput TRUE
  }
}

WorldInfo { }

NavigationInfo {
  type "NONE"
  headlight FALSE
}

Viewpoint {
  position 19.2 8.395 29.0642
  centerOfRotation 19.2 8.975 0
}

DirectionalLight {
  direction 0 -1 0
}

DEF _2 Noise {
  enabled TRUE
  frequency 2.4
}

DEF Display Transform {
  children Shape {
    geometry DEF _3 GraphicDisplay {
      width 35
      height 40
      size 1 0.4
    }
  }
}

DEF DisplayReflection Transform {
  rotation 0 0.707106781188933 -0.707106781184162 3.1415978482863
  scale -1 -1 -1
  children Shape {
    appearance Appearance {
      material Material {
        transparency 0.77
      }
    }
    geometry USE _3
  }
}

ROUTE _2.value_changed TO _3.set_value
